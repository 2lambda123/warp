"use strict";(self.webpackChunkwarp_docs=self.webpackChunkwarp_docs||[]).push([[457],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=s(n),m=r,k=u["".concat(p,".").concat(m)]||u[m]||c[m]||l;return n?a.createElement(k,o(o({ref:t},d),{},{components:n})):a.createElement(k,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=u;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7403:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const l={title:"Installation and Usage"},o=void 0,i={unversionedId:"getting_started/a-usage-and-installation",id:"getting_started/a-usage-and-installation",title:"Installation and Usage",description:"Installation",source:"@site/docs/getting_started/a-usage-and-installation.mdx",sourceDirName:"getting_started",slug:"/getting_started/a-usage-and-installation",permalink:"/warp/docs/getting_started/a-usage-and-installation",editUrl:"https://github.com/NethermindEth/warp/tree/develop/docs/docs/getting_started/a-usage-and-installation.mdx",tags:[],version:"current",frontMatter:{title:"Installation and Usage"},sidebar:"tutorialSidebar",previous:{title:"Getting Started",permalink:"/warp/docs/category/getting-started"},next:{title:"Warp Command Line Interface",permalink:"/warp/docs/getting_started/cli"}},p=[{value:"Installation",id:"installation",children:[{value:"Dependencies",id:"dependencies",children:[],level:3},{value:"Warp Installation Method 1",id:"warp-installation-method-1",children:[],level:3},{value:"Warp Installation Method 2 (from source/for devs)",id:"warp-installation-method-2-from-sourcefor-devs",children:[],level:3}],level:2},{value:"Usage",id:"usage",children:[{value:"Transpiling",id:"transpiling",children:[],level:3},{value:"Deploying",id:"deploying",children:[{value:"Note",id:"note",children:[],level:4}],level:3},{value:"A Detailed Example",id:"a-detailed-example",children:[],level:3}],level:2}],s={toc:p};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("h3",{id:"dependencies"},"Dependencies"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"You will need ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/Z3Prover/z3"},"z3")," installed to use Warp.")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Install command on macOS:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"brew install z3\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Install command on Ubuntu:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sudo apt install libz3-dev\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Install Python3.9 with dev dependencies (",(0,r.kt)("inlineCode",{parentName:"li"},"python3.9 python3.9-venv python3.9-dev"),") into your base env.\nIf you do not have the dev dependencies installed the installation will fail.")),(0,r.kt)("h3",{id:"warp-installation-method-1"},"Warp Installation Method 1"),(0,r.kt)("p",null,"Without any virtual environment activated perform the following in order:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Add the warp package from npm.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn global add @nethermindeth/warp\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Ensure the package was added by checking the version number:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp version\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Install the dependencies:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp install\n")),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Test the installation worked by transpiling an example ERC20 contract:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp transpile example_contracts/ERC20.sol\n")),(0,r.kt)("h3",{id:"warp-installation-method-2-from-sourcefor-devs"},"Warp Installation Method 2 (from source/for devs)"),(0,r.kt)("p",null,"Make sure you have the ",(0,r.kt)("a",{parentName:"p",href:"#dependencies"},"dependencies")," installed first."),(0,r.kt)("p",null,"With a virtual environment (recommended Python3.9) activated:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clone this repo and change directory into the ",(0,r.kt)("inlineCode",{parentName:"p"},"warp")," folder.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Install the JavaScript dependencies:"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Install the Python dependencies:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"pip install -r requirements.txt\n")),(0,r.kt)("p",null,"If you are using an M1 chipped Mac and getting a ",(0,r.kt)("inlineCode",{parentName:"p"},"'gmp.h' file not found")," error when installing Cairo run the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"CFLAGS=-Ibrew --prefix gmp/include LDFLAGS=-Lbrew --prefix gmp/lib pip install ecdsa fastecdsa sympy\n")),(0,r.kt)("p",null,"Then run the pip command above again."),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Compile the project:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"yarn tsc\nyarn warplib\n")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Test the installation worked by transpiling an example ERC20 contract:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"bin/warp transpile example_contracts/ERC20.sol\n")),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("p",null,"Warp 2 allows transpiling directly from Solidity to Cairo and the transpiled .cairo file can be deployed to starknet."),(0,r.kt)("h3",{id:"transpiling"},"Transpiling"),(0,r.kt)("p",null,"To transpile a solidity file, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp transpile [PATH_TO_SOLIDITY_FILE]\n")),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp transpile contracts/token/ERC20/ERC20.sol\n")),(0,r.kt)("p",null,"The output of the transpilation could be found in warp_output folder."),(0,r.kt)("p",null,"Now, the file can be compiled and deployed. Run the following to compile the Cairo contract:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp compile warp_output/contracts/token/ERC20/ERC20__WARP_CONTRACT__ERC20.cairo\n")),(0,r.kt)("h3",{id:"deploying"},"Deploying"),(0,r.kt)("p",null,"Cairo0.10 now requires the declaration of a contract if a user is going to use a wallet to deploy.\nIf a wallet is not needed then you can add the ",(0,r.kt)("inlineCode",{parentName:"p"},"--no_wallet")," flag to the end of the ",(0,r.kt)("inlineCode",{parentName:"p"},"deploy")," command and skip the ",(0,r.kt)("inlineCode",{parentName:"p"},"declare"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp declare [PATH_TO_TRANSPILED_CAIRO_CONTRACT]\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp deploy [PATH_TO_TRANSPILED_CAIRO_CONTRACT]  --inputs  [INPUT_ARGUMENTS]\n")),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'warp deploy warp_output/demo__WARP_CONTRACT__inputs.cairo  --inputs  \\"NETHERCOIN\\",\\"NTHCOIN\\",10,\\[5,4,2\\]\n')),(0,r.kt)("h4",{id:"note"},"Note"),(0,r.kt)("p",null,"The above deployment method uses ",(0,r.kt)("inlineCode",{parentName:"p"},"solidity abi")," which makes it easier for user to pass the arguments. There is also another method\nfor deploying which uses ",(0,r.kt)("inlineCode",{parentName:"p"},"cairo abi")," where we need to pass the length of the arrays and the value of each byte. You can refer ",(0,r.kt)("a",{parentName:"p",href:"https://www.cairo-lang.org/docs/"},"Cairo Docs")," for more information.\nWhen using --use_cairo_abi, one thing to take care of is it only supports negative numbers in 2's complement form."),(0,r.kt)("h3",{id:"a-detailed-example"},"A Detailed Example"),(0,r.kt)("p",null,"Let us get hands-on with the transpiling and deploying process starting with a solidity file using warp cli commands."),(0,r.kt)("p",null,"We have a solidity smart contract file named ",(0,r.kt)("inlineCode",{parentName:"p"},"simple.sol")," with code :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"pragma solidity ^0.8;\n\ncontract foo {\n  uint256 x;\n\n  constructor(uint256 _x) {\n    x = _x;\n  }\n}\n")),(0,r.kt)("p",null,"Now, to transpile it to cairo, we need to run the following command :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"\nwarp transpile simple.sol\n\n")),(0,r.kt)("p",null,"The output file(.cairo) which you can find in warp_output folder looks like :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"%lang starknet\n\nfrom warplib.maths.external_input_check_ints import warp_external_input_check_int256\nfrom starkware.cairo.common.uint256 import Uint256\nfrom starkware.cairo.common.cairo_builtins import HashBuiltin\n\nfunc WS_WRITE0{syscall_ptr : felt*, pedersen_ptr : HashBuiltin*, range_check_ptr : felt}(\n    loc : felt, value : Uint256\n) -> (res : Uint256):\n    WARP_STORAGE.write(loc, value.low)\n    WARP_STORAGE.write(loc + 1, value.high)\n    return (value)\nend\n\n# Contract Def foo\n\n@storage_var\nfunc WARP_STORAGE(index : felt) -> (val : felt):\nend\n@storage_var\nfunc WARP_USED_STORAGE() -> (val : felt):\nend\n@storage_var\nfunc WARP_NAMEGEN() -> (name : felt):\nend\nfunc readId{syscall_ptr : felt*, pedersen_ptr : HashBuiltin*, range_check_ptr : felt}(\n    loc : felt\n) -> (val : felt):\n    alloc_locals\n    let (id) = WARP_STORAGE.read(loc)\n    if id == 0:\n        let (id) = WARP_NAMEGEN.read()\n        WARP_NAMEGEN.write(id + 1)\n        WARP_STORAGE.write(loc, id + 1)\n        return (id + 1)\n    else:\n        return (id)\n    end\nend\n\nnamespace foo:\n    # Dynamic variables - Arrays and Maps\n\n    # Static variables\n\n    const __warp_usrid_0_x = 0\n\n    @constructor\n    func constructor{syscall_ptr : felt*, pedersen_ptr : HashBuiltin*, range_check_ptr : felt}(\n        __warp_usrid_1__x : Uint256\n    ):\n        alloc_locals\n        WARP_USED_STORAGE.write(2)\n\n        warp_external_input_check_int256(__warp_usrid_1__x)\n\n        WS_WRITE0(__warp_usrid_0_x, __warp_usrid_1__x)\n\n        return ()\n    end\nend\n\n")),(0,r.kt)("p",null,"If you want to compile the cairo file, you can run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"\nwarp compile warp_output/simple__WC__foo.cairo\n\n")),(0,r.kt)("p",null,"Please check if the path is correct, as it may be different on your system."),(0,r.kt)("p",null,"In order to deploy the contract to starknet the contract needs to be declared and then deployed:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp declare warp_output/simple__WC__foo.cairo\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp deploy warp_output/simple__WC__foo.cairo --inputs 2\n")),(0,r.kt)("p",null,"If you wish to deploy the contract without the use of a wallet, you can run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"warp deploy warp_output/simple__WC__foo.cairo --inputs 2 --no_wallet\n")))}d.isMDXComponent=!0}}]);